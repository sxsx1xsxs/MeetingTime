{% extends 'manage_event/sidebar.html' %}
{% block content %}

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<br>
<button onclick="location.href='{% url 'manage_event:abort_event_detail' event.id %}'">Abort event</button>
<br>

<h1>{{ event.event_name }} is on going, and the current status is: </h1>
    <style type="text/css" media="screen">
    table#power_schedule td {
        width: 140px;
    }

    table#power_schedule td.selectable,
    table#power_schedule th {
        font-size: 10px;
        width: 70px;
        height: 15px;
        text-align: center;
    }

    table#power_schedule td.selectable {
        width: 60px;
        background-color: #FFFFFF;
        border: 1px solid #D9D9D9;
    }

    table#power_schedule td.highlighted {
        background-color: #99E6FF;
        border: 1px solid #00ACE6;
    }

    table#power_schedule td:first-child {
        cursor: pointer;
    }


    </style>

    <table cellpadding="0" cellspacing="0" id="power_schedule">
        <tr id="firstRow">
            <th/>
            <!--<th>Mon</th>-->
            <!--<th>Tue</th>-->
            <!--<th>Wed</th>-->
            <!--<th>Thu</th>-->
            <!--<th>Fri</th>-->
            <!--<th>Sat</th>-->
            <!--<th>Sun</th>-->

        </tr>
        <!--<tr id="secondRow">-->
            <!--<td>08:00-09:00</td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
            <!--<td class="selectable"> </td>-->
        <!--</tr>-->
    </table>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
    <script>


    var originalTimeslots;
    var originaltimeslotsjson = $.getJSON( "../make_decision_json", function(json) {

  console.log( "success" );
  console.log(json);
  originalTimeslots = json;

 var timeslots = {};
 var date;

 for (entry in originalTimeslots) {
    var items = entry.split(" ");
    if (date != items[0]) {
        date = items[0];
        timeslots[date] = {};
        timeslots[date][items[1]] = originalTimeslots[entry];
    }else {
        timeslots[date][items[1]] = originalTimeslots[entry];
    }
 }

 var firstColumn = timeslots[Object.keys(timeslots)[0]];
 var counter = 0;

 for (day in timeslots) {
     firstColumn = timeslots[day];
     document.getElementById("firstRow").innerHTML += "<td>"+day+"</td>";
 }

 for (time in firstColumn) {
    if (counter % 2 == 0){
    document.getElementById("power_schedule").innerHTML += "<tr id= "+time+">" + "<td>"+time+"</td>" +"</tr>";
    } else {
    document.getElementById("power_schedule").innerHTML += "<tr id= "+time+">" + "<td>"+ "" +"</td>" +"</tr>";
    }
    for (day in timeslots) {
          if (timeslots[day][time] == "0") {
          document.getElementById(time).innerHTML += "<td class='selectable' id='" +day+" "+time+"'> </td>";
          } else {
          document.getElementById(time).innerHTML += "<td class='selectable highlighted' id='" +day+" "+time+"'> " + timeslots[day][time] + " </td>";
          }
    }
    counter += 1;
 }
 })

    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" charset="utf-8">

    </script>
    <br><button onclick="location.href='{% url 'manage_event:organize_index' %}'">Back to organize events</button>

{% endblock%}
